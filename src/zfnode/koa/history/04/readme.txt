完成next处理，并添加error监听