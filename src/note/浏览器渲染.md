# 浏览器渲染

> - 平常的浏览的网页是不是应用
> - 再操作系统中的应用是如何运行的
> - 浏览器究竟是什么
> - webkit和浏览器的关系
> - 浏览器是如何呈现网页的
> - 经典的问： 从输入网址到页面展示完毕，发生了什么
> - 性能优化方面

### 基本概念

- **浏览器**

  > 浏览器是用户访问互联网的最重要的接口，本质上，浏览器是一般互联网用户通过界面解析和发送HTTP协议的软件

- 浏览器历史

  - 1991年，世界第一个历览器worldWideWeb(后该文Nexus),功能简单，不支持图片
  - 1993年， Mosaic浏览器出现。可以显示图片，为了区分浏览器是否能展示图片，出现了UserAgent
  - 1994年，Mozilla浏览器出现，也就是后来大名鼎鼎的网景浏览器Netscape，它的UserAgent为Mozilla/1.0
  - 1995年，IE浏览器出现，为了抢夺市场，UserAgent为Mozilla/1.22
  - 1998年，网景公司失利，成了子Mozilla组织
  - 2003年，网景公司解散，Mozilla基金会成立，这个组织推进了后来的Firefox
  - Mozilla开发了Geoko，编成了Firefox，他的UserAgentMozilla/5.0
  - 群雄并起，众多公司的浏览器UserAgent上都带有Mozilla
  - chrome和safari，占有了很大的份额

- 查看用户代理

  - 开发chrome 控制台， 
  - 输入`navigator.userAgent`
  - 会发现`"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36"`字段

- 用户代理的作用

  - 判断浏览器类型，采用兼容方案
  - 判断浏览器是否为移动端
  - 识别H5容器，方便调用H5容器特定接口
  - userAgent伪装成本很低，不能太依赖

- 内核

  > 对于操作系统来说，内核是操作系统的核心，是第一层基于硬件的软件扩充，提供最核心最基础的服务。
  >
  > 对于浏览器来说，统样存在浏览器内核，也操作系统内核类似。浏览器内核需要提供api给浏览器开发者使用，同时提供最核心的功能，如页面渲染，js运行引起

### 浏览器内核知识



### Chromium架构

> 基于webkit那颗就可以构建浏览器应用

### 现在浏览器的工作

- 资源管理
- 多页面管理，也就是多个标签页的管理
- 插件和扩展，付flash，chrome扩展程序
- 账户和同步
- 安全机制
- 多系统支持

### 进程和线程

- 进程：对cpu， 贮存，io设别的抽象，操作系统对一个正在运行的程序抽象
- 线程：组成进程的执行单元，运行在进程的上下文中的逻辑流
- 进程通信：进程之间相互传递信息
- 线程同步

### 多进程模型的优劣势

- 拥有资源隔离，某个渲染进程奔溃不会导致主程序退出
- 编成模型较为清晰
- 进程间通信IPC开销大

### 线程同步

- 同一个进程下的线程可以读写相同的共享数据
- 由于会操作共享数据，所以存在竞太，
- 线程同步即为使线程以预期方式操作共享数据的调度机制
- 经典方法为信号量

### chromium的多进程架构

### 其他影响渲染的因素

- 设备独立像素 dp
- 物理像素pp = dp *160/dpi
- devicePixeiRatio 设备像素比
- dpi 每英寸的像素点数 dpi = (dp/pp)*160